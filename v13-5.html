<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 Okayama V13 Dashboard</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // ÂæûÂÖ®ÂüüËÆÄÂèñÈÖçÁΩÆÔºåËã•‰∏çÂ≠òÂú®ÂâáÁµ¶‰∫àÁ©∫ÂÄºÈÅøÂÖçÂ¥©ÊΩ∞
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {
            apiKey: "", authDomain: "", projectId: "", storageBucket: "", messagingSenderId: "", appId: ""
        };

        // ÂãïÊÖãÂºïÂÖ• Firebase (GitHub Pages ÊîØÊè¥ ESM)
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-auth.js";
        import { getFirestore, collection, doc, setDoc, onSnapshot, addDoc, deleteDoc, updateDoc, query } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-firestore.js";

        const { useState, useEffect, useRef } = React;

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'okayama-2026-v13';

        const EXCHANGE_RATE = 0.21;
        const JPY_RATE = 4.76;

        const DATES = [
            { d: '02-28', w: 'ÂÖ≠', id: 'day1' }, { d: '03-01', w: 'Êó•', id: 'day2' },
            { d: '03-02', w: '‰∏Ä', id: 'day3' }, { d: '03-03', w: '‰∫å', id: 'day4' },
            { d: '03-04', w: '‰∏â', id: 'day5' }, { d: '03-05', w: 'Âõõ', id: 'day6' },
            { d: '03-06', w: '‰∫î', id: 'day7' }, { d: '03-07', w: 'ÂÖ≠', id: 'day8' },
            { d: '03-08', w: 'Êó•', id: 'day9' }
        ];

        const HOURS = Array.from({ length: 48 }, (_, i) => {
            const h = Math.floor(i / 2).toString().padStart(2, '0');
            const m = i % 2 === 0 ? '00' : '30';
            return `${h}:${m}`;
        });

        const PARTNERS = [
            { id: 'salt', name: 'Â°©', emoji: 'üßÇ' },
            { id: 'monkey', name: 'Áå¥', emoji: 'üêµ' }
        ];

        function App() {
            const [user, setUser] = useState(null);
            const [activeTab, setActiveTab] = useState('home');
            const [adminSection, setAdminSection] = useState('itinerary');
            const [selectedDay, setSelectedDay] = useState('day1');
            const [selectedPayer, setSelectedPayer] = useState('salt');
            const [showExpenseModal, setShowExpenseModal] = useState(false);
            
            const [itinerary, setItinerary] = useState({});
            const [expenses, setExpenses] = useState([]);
            const [settings, setSettings] = useState({
                outbound: { airline: 'Tigerair', no: 'IT214', terminal: 'T1', gate: '-', boardingTime: '11:00', duration: '2h 30m', arrivalTime: '15:00', carryOn: '10kg', checkedCount: '1', checkedWeight: '20kg' },
                return: { airline: 'Tigerair', no: 'IT215', terminal: 'T1', gate: '-', boardingTime: '11:00', duration: '2h 30m', arrivalTime: '15:00', carryOn: '10kg', checkedCount: '1', checkedWeight: '20kg' },
                paymentMethods: ['ÁèæÈáë', '‰ø°Áî®Âç°', 'Suica', 'Apple Pay'],
                transportMethods: ['JR', 'Ë∑ØÈù¢ÈõªËªä', 'Êé•ÈßÅËªä', 'Ê≠•Ë°å', 'Ë®àÁ®ãËªä'],
                accommodations: [],
                esim: { salt: { days: '8', data: 'ÁÑ°ÈôêÂà∂', note: '', img: '' }, monkey: { days: '8', data: 'ÁÑ°ÈôêÂà∂', note: '', img: '' } },
                passes: []
            });

            useEffect(() => {
                const initAuth = async () => {
                    if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                        await signInWithCustomToken(auth, __initial_auth_token);
                    } else {
                        await signInAnonymously(auth);
                    }
                };
                initAuth();
                return onAuthStateChanged(auth, setUser);
            }, []);

            useEffect(() => {
                if (!user) return;
                const unsubItn = onSnapshot(collection(db, 'artifacts', appId, 'public', 'data', 'itinerary'), s => {
                    const d = {}; s.forEach(doc => d[doc.id] = doc.data()); setItinerary(d);
                }, (err) => console.error(err));

                const unsubExp = onSnapshot(collection(db, 'artifacts', appId, 'public', 'data', 'expenses'), s => {
                    setExpenses(s.docs.map(d => ({ id: d.id, ...d.data() })));
                }, (err) => console.error(err));

                const unsubSet = onSnapshot(doc(db, 'artifacts', appId, 'public', 'data', 'settings', 'main'), s => {
                    if (s.exists()) setSettings(prev => ({ ...prev, ...s.data() }));
                }, (err) => console.error(err));

                return () => { unsubItn(); unsubExp(); unsubSet(); };
            }, [user]);

            const updateSettings = async (path, value) => {
                const newSettings = { ...settings };
                const keys = path.split('.');
                let current = newSettings;
                for (let i = 0; i < keys.length - 1; i++) {
                    if (!current[keys[i]]) current[keys[i]] = {};
                    current = current[keys[i]];
                }
                current[keys[keys.length - 1]] = value;
                setSettings(newSettings);
                await setDoc(doc(db, 'artifacts', appId, 'public', 'data', 'settings', 'main'), newSettings, { merge: true });
            };

            const handleImageUpload = (memberId, file) => {
                if (!file) return;
                const reader = new FileReader();
                reader.onloadend = async () => {
                    await updateSettings(`esim.${memberId}.img`, reader.result);
                };
                reader.readAsDataURL(file);
            };

            const getMemberTotal = (uid) => {
                return expenses
                    .filter(e => e.userId === uid)
                    .reduce((sum, e) => sum + (e.amount || 0), 0);
            };

            const SectionCard = ({ title, icon, children, action }) => (
                <div className="bg-white rounded-[2rem] p-6 md:p-8 border border-slate-200 shadow-sm mb-6 w-full">
                    <div className="flex items-center justify-between mb-6">
                        <div className="flex items-center gap-3">
                            <span className="text-2xl">{icon}</span>
                            <h2 className="text-xl font-black text-slate-800 tracking-tight">{title}</h2>
                        </div>
                        {action}
                    </div>
                    {children}
                </div>
            );

            const FlightCard = ({ title, flight, color }) => (
                <div className={`rounded-3xl p-6 text-white ${color} relative overflow-hidden h-full shadow-lg`}>
                    <h3 className="text-[10px] font-black uppercase tracking-widest mb-6 opacity-60">{title} ‚Ä¢ {flight?.no}</h3>
                    <div className="flex justify-between items-center mb-8">
                        <div className="text-center">
                            <div className="text-3xl font-black">{title.includes('Âéª') ? 'TPE' : 'UKB'}</div>
                            <div className="text-[9px] font-bold opacity-50 uppercase">{flight?.airline}</div>
                        </div>
                        <div className="flex-1 px-4 text-center text-2xl">‚úàÔ∏è</div>
                        <div className="text-center">
                            <div className="text-3xl font-black">{title.includes('Âéª') ? 'OKJ' : 'TPE'}</div>
                            <div className="text-[9px] font-bold opacity-50 uppercase">{title.includes('Âéª') ? 'Okayama' : 'Taipei'}</div>
                        </div>
                    </div>
                    <div className="grid grid-cols-2 md:grid-cols-4 gap-4 border-t border-white/10 pt-6">
                        <div><div className="text-[8px] opacity-40 font-black uppercase mb-1">Ëà™Âªà/ÁôªÊ©üÈñÄ</div><div className="text-sm font-bold">{flight?.terminal} / {flight?.gate}</div></div>
                        <div><div className="text-[8px] opacity-40 font-black uppercase mb-1">ÁôªÊ©üÊôÇÈñì</div><div className="text-sm font-bold">{flight?.boardingTime}</div></div>
                        <div><div className="text-[8px] opacity-40 font-black uppercase mb-1">ÊäµÈÅîÊôÇÈñì</div><div className="text-sm font-bold">{flight?.arrivalTime}</div></div>
                        <div><div className="text-[8px] opacity-40 font-black uppercase mb-1">Ë°åÊùéÈÖçÈ°ç</div><div className="text-[10px] font-bold">üß≥ {flight?.checkedCount}‰ª∂ {flight?.checkedWeight} / üéí {flight?.carryOn}</div></div>
                    </div>
                </div>
            );

            return (
                <div className="min-h-screen bg-[#f8fafc] text-slate-900 pb-20 font-sans">
                    <header className="sticky top-0 z-50 p-4">
                        <div className="max-w-6xl mx-auto rounded-[2rem] bg-white/80 backdrop-blur-xl border border-white shadow-lg p-2 flex items-center justify-between">
                            <div className="flex items-center gap-3 pl-4 cursor-pointer" onClick={() => setActiveTab('home')}>
                                <span className="text-xl">üçë</span>
                                <span className="font-black text-sm tracking-tighter uppercase hidden sm:block">Okayama V13</span>
                            </div>
                            <nav className="flex gap-1 overflow-x-auto no-scrollbar">
                                {['home', 'itinerary', 'accounting', 'tickets', 'admin'].map(id => (
                                    <button key={id} onClick={() => setActiveTab(id)} className={`px-4 py-2 rounded-xl font-bold text-[10px] uppercase tracking-wider transition-all whitespace-nowrap ${activeTab === id ? 'bg-slate-900 text-white shadow-md' : 'text-slate-500 hover:bg-slate-50'}`}>
                                        {id === 'home' && 'Á∏ΩË¶Ω'}
                                        {id === 'itinerary' && 'Ë°åÁ®ã'}
                                        {id === 'accounting' && 'Ë®òÂ∏≥'}
                                        {id === 'tickets' && 'Á•®Âà∏/ESIM'}
                                        {id === 'admin' && 'ÁÆ°ÁêÜ'}
                                    </button>
                                ))}
                            </nav>
                            <div className="flex gap-2 pr-2">
                                {PARTNERS.map(p => (
                                    <button key={p.id} className={`w-8 h-8 rounded-full border-2 transition-all flex items-center justify-center text-sm ${selectedPayer === p.id ? 'border-indigo-500 bg-indigo-50 scale-110' : 'border-transparent opacity-40 grayscale'}`} onClick={() => setSelectedPayer(p.id)}>{p.emoji}</button>
                                ))}
                            </div>
                        </div>
                    </header>

                    <main className="max-w-6xl mx-auto px-4 mt-6">
                        {activeTab === 'home' && (
                            <div className="space-y-6">
                                <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                    <FlightCard title="ÂéªÁ®ãËà™Áè≠ (TPE-OKJ)" flight={settings.outbound} color="bg-slate-900" />
                                    <FlightCard title="ÂõûÁ®ãËà™Áè≠ (UKB-TPE)" flight={settings.return} color="bg-indigo-900" />
                                </div>
                                <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                                    <div className="md:col-span-2 bg-white rounded-[2rem] p-8 border border-slate-200">
                                        <h3 className="text-[10px] font-black text-slate-400 uppercase tracking-widest mb-6">ÁõÆÂâçÁöÑÊàêÂì°Á∏ΩÊîØÂá∫</h3>
                                        <div className="grid grid-cols-2 gap-8">
                                            {PARTNERS.map(p => {
                                                const jpy = getMemberTotal(p.id);
                                                return (
                                                    <div key={p.id} className="relative p-6 bg-slate-50 rounded-3xl overflow-hidden">
                                                        <div className="absolute top-4 right-4 text-3xl opacity-20">{p.emoji}</div>
                                                        <div className="text-[10px] font-black text-slate-400 uppercase mb-1">{p.name} Â∑≤Ëä±Ë≤ª</div>
                                                        <div className="text-2xl font-black text-slate-800">¬•{Math.round(jpy).toLocaleString()}</div>
                                                        <div className="text-xs font-bold text-indigo-500 mt-1">‚âà ${Math.round(jpy * EXCHANGE_RATE).toLocaleString()} TWD</div>
                                                    </div>
                                                );
                                            })}
                                        </div>
                                    </div>
                                    <div className="bg-white rounded-[2rem] p-8 border border-slate-200">
                                        <h3 className="text-[10px] font-black text-slate-400 uppercase tracking-widest mb-4">È¶ñÈñì‰ΩèÂÆø</h3>
                                        <div className="text-lg font-black text-slate-800 line-clamp-1">{settings.accommodations?.[0]?.name || "Â∞öÊú™Ë®≠ÂÆö"}</div>
                                        <div className="text-[10px] text-slate-400 mt-2 line-clamp-1">{settings.accommodations?.[0]?.address}</div>
                                        <div className="mt-6 pt-6 border-t border-slate-100 flex justify-between items-center">
                                            <span className="text-[9px] font-black text-slate-400 uppercase">ÂÖ•‰ΩèÊôÇÈñì</span>
                                            <span className="text-xs font-bold">{settings.accommodations?.[0]?.checkIn || "--"}</span>
                                        </div>
                                    </div>
                                </div>
                                <SectionCard title="9Êó•Ë°åÁ®ãÂø´Ë¶Ω" icon="üó∫Ô∏è">
                                    <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                                        {DATES.map(d => (
                                            <div key={d.id} className="p-5 bg-slate-50 rounded-[1.5rem] border border-slate-100 hover:border-indigo-200 transition-all group">
                                                <div className="flex justify-between items-start mb-3">
                                                    <div className="px-3 py-1 bg-white rounded-lg text-[9px] font-black text-slate-400 shadow-sm">{d.d} ({d.w})</div>
                                                    <div className="text-[9px] font-black text-indigo-500 uppercase tracking-widest">{itinerary[d.id]?.area || "Êú™Ë®≠ÂÆöÂú∞Èªû"}</div>
                                                </div>
                                                <div className="text-sm font-black text-slate-700 leading-tight group-hover:text-indigo-600 transition-colors">
                                                    {itinerary[d.id]?.slogan || "Â∞öÊú™Â°´ÂØ´‰ªäÊó•‰∏ªÈ°å..."}
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </SectionCard>
                            </div>
                        )}

                        {activeTab === 'tickets' && (
                            <div className="space-y-6">
                                <SectionCard title="‰∫§ÈÄöÁ•®Âà∏Ë≥áÁî¢" icon="üé´">
                                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                        {[...(settings.passes || [])]
                                            .sort((a, b) => (b.purchased ? 1 : 0) - (a.purchased ? 1 : 0))
                                            .map((pass, i) => (
                                            <div key={i} className={`p-6 rounded-[2rem] border relative overflow-hidden transition-all ${pass.purchased ? 'bg-indigo-50 border-indigo-100' : 'bg-slate-50 border-slate-100 opacity-80'}`}>
                                                {pass.purchased && <div className="absolute top-3 right-3 bg-indigo-500 text-white text-[8px] font-black px-2 py-0.5 rounded-full uppercase">Â∑≤Ë≥ºË≤∑</div>}
                                                <div className="text-[8px] font-black text-slate-400 uppercase mb-2">{pass.area} ‚Ä¢ {pass.days} Â§©</div>
                                                <div className="text-lg font-black text-slate-800 mb-1">{pass.name}</div>
                                                <div className="text-xl font-black text-slate-900 mb-2">
                                                    {pass.currency === 'JPY' ? `¬•${pass.price?.toLocaleString()}` : `$${pass.price?.toLocaleString()}`}
                                                </div>
                                                {pass.useDateStart && (
                                                    <div className="text-[9px] font-bold text-indigo-400 bg-white/50 inline-block px-2 py-1 rounded-md mb-3">
                                                        üìÖ {pass.useDateStart} ~ {pass.useDateEnd || 'End'}
                                                    </div>
                                                )}
                                                {pass.note && <div className="text-[10px] text-slate-400 mb-3 line-clamp-2">{pass.note}</div>}
                                                {pass.link && <a href={pass.link} target="_blank" className="inline-block text-[10px] font-black uppercase text-indigo-600 underline">Êü•ÁúãÁ•®Âà∏ÈÄ£Áµê</a>}
                                            </div>
                                        ))}
                                    </div>
                                </SectionCard>
                                <SectionCard title="eSIM ÊÜëË≠â" icon="üì∂">
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                                        {PARTNERS.map(p => (
                                            <div key={p.id} className="bg-white border border-slate-100 rounded-[2rem] overflow-hidden shadow-sm text-center p-8">
                                                <div className="text-4xl mb-4">{p.emoji}</div>
                                                <div className="text-xl font-black mb-2">{p.name} ÁöÑ eSIM</div>
                                                <div className="text-[10px] font-bold text-slate-400 uppercase mb-6">{settings.esim?.[p.id]?.days} Â§© ‚Ä¢ {settings.esim?.[p.id]?.data}</div>
                                                {settings.esim?.[p.id]?.img ? (
                                                    <div className="mx-auto max-w-[200px] border-4 border-slate-50 rounded-2xl overflow-hidden mb-4 shadow-inner">
                                                        <img src={settings.esim[p.id].img} alt="QR Code" className="w-full" />
                                                    </div>
                                                ) : (
                                                    <div className="h-40 flex items-center justify-center bg-slate-50 rounded-2xl mb-4 text-slate-300 text-[10px] font-bold uppercase">ÂæåÂè∞Â∞çÊáâÊàêÂì°‰∏äÂÇ≥ÂúñÁâá</div>
                                                )}
                                                <div className="text-xs text-slate-400 italic">{settings.esim?.[p.id]?.note}</div>
                                            </div>
                                        ))}
                                    </div>
                                </SectionCard>
                            </div>
                        )}

                        {activeTab === 'itinerary' && (
                            <div className="space-y-6">
                                <div className="flex gap-2 overflow-x-auto no-scrollbar pb-2">
                                    {DATES.map(d => (
                                        <button key={d.id} onClick={() => setSelectedDay(d.id)} className={`px-6 py-3 rounded-2xl font-black text-[10px] uppercase transition-all whitespace-nowrap ${selectedDay === d.id ? 'bg-slate-900 text-white shadow-md' : 'bg-white text-slate-400 border border-slate-100'}`}>
                                            {d.d} {d.w}
                                        </button>
                                    ))}
                                </div>
                                <SectionCard title={`${selectedDay.toUpperCase()} Ë°åÁ®ã - ${itinerary[selectedDay]?.area || 'Âú∞ÂçÄ'}`} icon="üìã">
                                    <div className="mb-6 p-4 bg-indigo-50 rounded-2xl border border-indigo-100">
                                        <span className="text-[9px] font-black text-indigo-400 uppercase block mb-1">‰ªäÊó•‰∏ªÈ°å Slogan</span>
                                        <span className="text-sm font-bold text-slate-700 italic">‚Äú {itinerary[selectedDay]?.slogan || "Êú™Ë®≠ÂÆö"} ‚Äù</span>
                                    </div>
                                    <div className="overflow-x-auto">
                                        <table className="w-full text-left min-w-[700px]">
                                            <thead>
                                                <tr className="border-b border-slate-100 uppercase text-[9px] font-black text-slate-400">
                                                    <th className="py-4 w-24">ÊôÇÈñì</th><th className="py-4">Ë°åÁ®ãÊ¥ªÂãï</th><th className="py-4 w-28">‰∫§ÈÄö</th><th className="py-4">Ë©≥Á¥∞ÂÇôË®ª</th><th className="py-4 w-16 text-center">Âú∞Âúñ</th>
                                                </tr>
                                            </thead>
                                            <tbody className="divide-y divide-slate-50">
                                                {(itinerary[selectedDay]?.slots || []).map((slot, i) => (
                                                    <tr key={i} className="text-sm">
                                                        <td className="py-5 font-black text-indigo-500">{slot.time}</td>
                                                        <td className="py-5 font-bold text-slate-700">{slot.activity}</td>
                                                        <td className="py-5"><span className="px-2 py-1 bg-slate-100 rounded text-[9px] font-black uppercase">{slot.transport}</span></td>
                                                        <td className="py-5 text-slate-400 text-[11px] leading-relaxed max-w-[200px] truncate">{slot.note}</td>
                                                        <td className="py-5 text-center">{slot.link && <a href={slot.link} target="_blank" className="grayscale hover:grayscale-0 transition-all">üìç</a>}</td>
                                                    </tr>
                                                ))}
                                            </tbody>
                                        </table>
                                    </div>
                                </SectionCard>
                            </div>
                        )}

                        {activeTab === 'accounting' && (
                             <SectionCard title={`${PARTNERS.find(p=>p.id===selectedPayer)?.name} ÊîØÂá∫Ê∏ÖÂñÆ`} icon="üí∞">
                                <div className="overflow-x-auto">
                                    <table className="w-full text-left">
                                        <thead className="text-[9px] font-black text-slate-400 uppercase tracking-widest border-b">
                                            <tr><th className="py-4">ÂìÅÈ†Ö</th><th className="py-4">ÊñπÂºè</th><th className="py-4 text-right">Êó•Âπ£ÈáëÈ°ç</th><th className="py-4 text-right">Âè∞Âπ£ÊèõÁÆó</th><th className="py-4 text-right">ÁÆ°ÁêÜ</th></tr>
                                        </thead>
                                        <tbody className="divide-y">
                                            {expenses.filter(e => e.userId === selectedPayer).map(e => (
                                                <tr key={e.id} className="text-sm">
                                                    <td className="py-4 font-bold">{e.item}</td>
                                                    <td className="py-4"><span className="px-2 py-1 bg-slate-50 rounded text-[10px] font-black text-slate-400">{e.method}</span></td>
                                                    <td className="py-4 text-right font-mono font-bold text-slate-600">¬•{Math.round(e.amount).toLocaleString()}</td>
                                                    <td className="py-4 text-right font-black text-indigo-500 tracking-tight">${Math.round(e.amount * EXCHANGE_RATE).toLocaleString()}</td>
                                                    <td className="py-4 text-right"><button onClick={async () => await deleteDoc(doc(db, 'artifacts', appId, 'public', 'data', 'expenses', e.id))} className="text-[10px] text-red-300 hover:text-red-500 font-bold">ÁßªÈô§</button></td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                             </SectionCard>
                        )}

                        {activeTab === 'admin' && (
                            <div className="grid grid-cols-1 md:grid-cols-4 gap-6 pb-20">
                                <div className="space-y-2">
                                    {[{id: 'itinerary', name: 'Ë°åÁ®ãÁ∑®ËºØ'}, {id: 'stay', name: '‰ΩèÂÆøÁÆ°ÁêÜ'}, {id: 'flight', name: 'Ëà™Áè≠Ëº∏ÂÖ•'}, {id: 'esim', name: 'eSIM ÁÆ°ÁêÜ'}, {id: 'pass', name: 'Á•®Âà∏Ë≥áÁî¢'}, {id: 'payment', name: 'Á≥ªÁµ±Ë®≠ÂÆö'}].map(s => (
                                        <button key={s.id} onClick={() => setAdminSection(s.id)} className={`w-full p-4 rounded-2xl text-left font-black text-[10px] uppercase tracking-wider transition-all ${adminSection === s.id ? 'bg-slate-900 text-white shadow-md' : 'bg-white text-slate-400 border border-slate-100'}`}>
                                            {s.name}
                                        </button>
                                    ))}
                                </div>
                                <div className="md:col-span-3 space-y-6">
                                    {adminSection === 'itinerary' && (
                                        <SectionCard title="Ë°åÁ®ãËàá‰∏ªÈ°åÁ∑®ËºØ" icon="üñãÔ∏è" action={<button onClick={async () => {
                                            const currentSlots = itinerary[selectedDay]?.slots || [];
                                            const newSlots = [...currentSlots, { time: "09:00", activity: "Êñ∞Ë°åÁ®ã", transport: settings.transportMethods[0], link: "", note: "" }];
                                            await setDoc(doc(db, 'artifacts', appId, 'public', 'data', 'itinerary', selectedDay), { slots: newSlots }, { merge: true });
                                        }} className="bg-slate-900 text-white px-4 py-2 rounded-xl text-[10px] font-black">+ Êñ∞Â¢ûÊôÇÊÆµ</button>}>
                                            <div className="flex gap-2 overflow-x-auto pb-4 mb-4 border-b border-slate-50">
                                                {DATES.map(d => (
                                                    <button key={d.id} onClick={() => setSelectedDay(d.id)} className={`px-4 py-2 rounded-xl text-[10px] font-black ${selectedDay === d.id ? 'bg-indigo-500 text-white' : 'bg-slate-100 text-slate-400'}`}>{d.id}</button>
                                                ))}
                                            </div>
                                            <div className="grid grid-cols-2 gap-4 mb-8 p-6 bg-indigo-50 rounded-3xl">
                                                <div>
                                                    <label className="text-[8px] font-black text-indigo-400 mb-1 block">‰ªäÊó•ÈÅäÁé©Âú∞ÂçÄ</label>
                                                    <input className="w-full p-2 bg-white rounded-lg text-xs font-bold" defaultValue={itinerary[selectedDay]?.area} onBlur={async (e) => await setDoc(doc(db, 'artifacts', appId, 'public', 'data', 'itinerary', selectedDay), { area: e.target.value }, { merge: true })} placeholder="‰æãÂ¶ÇÔºöÂ≤°Â±± / ÂÄâÊï∑" />
                                                </div>
                                                <div>
                                                    <label className="text-[8px] font-black text-indigo-400 mb-1 block">‰ªäÊó• Slogan (‰∏ªÈ°å)</label>
                                                    <input className="w-full p-2 bg-white rounded-lg text-xs" defaultValue={itinerary[selectedDay]?.slogan} onBlur={async (e) => await setDoc(doc(db, 'artifacts', appId, 'public', 'data', 'itinerary', selectedDay), { slogan: e.target.value }, { merge: true })} placeholder="‰∏ªÈ°åÊèèËø∞..." />
                                                </div>
                                            </div>
                                            <div className="space-y-4">
                                                {(itinerary[selectedDay]?.slots || []).map((slot, i) => (
                                                    <div key={i} className="bg-slate-50 p-6 rounded-3xl relative border border-slate-100">
                                                        <button className="absolute top-4 right-4 text-red-400 text-[10px] font-black" onClick={async () => {
                                                            const nl = [...itinerary[selectedDay].slots]; nl.splice(i, 1);
                                                            await setDoc(doc(db, 'artifacts', appId, 'public', 'data', 'itinerary', selectedDay), { slots: nl }, { merge: true });
                                                        }}>ÁßªÈô§</button>
                                                        <div className="grid grid-cols-1 md:grid-cols-12 gap-4 mb-4">
                                                            <div className="md:col-span-2">
                                                                <label className="text-[8px] font-black text-slate-400 mb-1 block">ÊôÇÈñì</label>
                                                                <select className="w-full p-2 bg-white rounded-lg text-xs" defaultValue={slot.time} onChange={e => {
                                                                    const ns = [...itinerary[selectedDay].slots]; ns[i].time = e.target.value;
                                                                    setDoc(doc(db, 'artifacts', appId, 'public', 'data', 'itinerary', selectedDay), { slots: ns }, { merge: true });
                                                                }}>
                                                                    {HOURS.map(h => <option key={h} value={h}>{h}</option>)}
                                                                </select>
                                                            </div>
                                                            <div className="md:col-span-6">
                                                                <label className="text-[8px] font-black text-slate-400 mb-1 block">Ë°åÁ®ãÂÖßÂÆπ</label>
                                                                <input className="w-full p-2 bg-white rounded-lg text-xs font-bold" defaultValue={slot.activity} onBlur={e => {
                                                                    const ns = [...itinerary[selectedDay].slots]; ns[i].activity = e.target.value;
                                                                    setDoc(doc(db, 'artifacts', appId, 'public', 'data', 'itinerary', selectedDay), { slots: ns }, { merge: true });
                                                                }} />
                                                            </div>
                                                            <div className="md:col-span-4">
                                                                <label className="text-[8px] font-black text-slate-400 mb-1 block">‰∫§ÈÄöÊñπÂºè</label>
                                                                <select className="w-full p-2 bg-white rounded-lg text-xs" defaultValue={slot.transport} onChange={e => {
                                                                    const ns = [...itinerary[selectedDay].slots]; ns[i].transport = e.target.value;
                                                                    setDoc(doc(db, 'artifacts', appId, 'public', 'data', 'itinerary', selectedDay), { slots: ns }, { merge: true });
                                                                }}>
                                                                    {settings.transportMethods.map(m => <option key={m} value={m}>{m}</option>)}
                                                                </select>
                                                            </div>
                                                        </div>
                                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                                            <input className="w-full p-2 bg-white rounded-lg text-[10px] font-mono" defaultValue={slot.link} onBlur={e => {
                                                                const ns = [...itinerary[selectedDay].slots]; ns[i].link = e.target.value;
                                                                setDoc(doc(db, 'artifacts', appId, 'public', 'data', 'itinerary', selectedDay), { slots: ns }, { merge: true });
                                                            }} placeholder="Map Link" />
                                                            <input className="w-full p-2 bg-white rounded-lg text-xs" defaultValue={slot.note} onBlur={e => {
                                                                const ns = [...itinerary[selectedDay].slots]; ns[i].note = e.target.value;
                                                                setDoc(doc(db, 'artifacts', appId, 'public', 'data', 'itinerary', selectedDay), { slots: ns }, { merge: true });
                                                            }} placeholder="ÂÇôË®ª" />
                                                        </div>
                                                    </div>
                                                ))}
                                            </div>
                                        </SectionCard>
                                    )}
                                </div>
                            </div>
                        )}
                    </main>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
